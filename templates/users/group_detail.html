{% extends "base.html" %}
{% load static %}
{% block title %}{{ group.name }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">

    {# Кавер / обложка #}
    {% if hero %}
      <div class="mb-3" style="border-radius:14px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.08);">
        <img src="{{ hero.url }}" alt="{{ group.name }}" style="width:100%;height:360px;object-fit:cover;">
      </div>
    {% endif %}

    <div class="card">
      <div class="card-body">

        {# Шапка: аватар + название + бейдж клуба + кнопка справа #}
        <div class="d-flex align-items-center justify-content-between mb-3">

          <div class="d-flex align-items-center">
            <div class="mr-3" style="width:48px;height:48px;border-radius:10px;overflow:hidden;background:#eee;">
              {% if avatar_ui %}
                <img src="{{ avatar_ui.url }}" alt="{{ group.name }}" style="width:100%;height:100%;object-fit:cover;">
              {% else %}
                <div class="w-100 h-100 d-flex align-items-center justify-content-center text-muted">—</div>
              {% endif %}
            </div>

            <div>
              <h1 class="h5 mb-1" style="font-weight:800;">{{ group.name }}</h1>

              <div class="small text-muted">
                Участников: {{ member_count|default:"—" }}
                {% if gp and gp.club %}
                  <span class="badge-club ml-2">Клуб: {{ gp.club.name }}</span>
                {% endif %}
              </div>
            </div>
          </div>

          {# Кнопка-присоединиться/выйти — пилюля в цветах темы #}
          <div class="ml-3">
            {% if user.is_authenticated %}
              {% if is_member %}
                <form method="post" action="{% url 'users:group_leave' group.pk %}" class="m-0 p-0 d-inline">
                  {% csrf_token %}
                  <button type="submit" class="btn-chip-yellow">Выйти</button>
                </form>
              {% else %}
                <form method="post" action="{% url 'users:group_join' group.pk %}" class="m-0 p-0 d-inline">
                  {% csrf_token %}
                  <button type="submit" class="btn-chip-yellow">Вступить в группу</button>
                </form>
              {% endif %}
            {% else %}
              <a class="btn-chip-yellow" href="{% url 'users:login' %}?next={{ request.path }}">Войти, чтобы вступить</a>
            {% endif %}
          </div>
        </div>

        {# Метка «Место встречи» — мягкий акцент #}
        {% if gp and gp.meet_place %}
          <p class="meta-text mb-3">
            <strong>Место встречи:</strong> {{ gp.meet_place }}
          </p>
        {% endif %}

        {# Описание #}
        {% if gp and gp.description %}
          <div class="group-description">
            {{ gp.description|linebreaks }}
          </div>
        {% else %}
          <div class="text-muted">Описание пока не добавлено.</div>
        {% endif %}

      </div>
    </div>

  </div>
</div>
{% endblock %}














